---
confluence-id: '309997970'
orig-title: What packets are counted in "Forwarded bps" and "Forwarded pps" statistics
  (and SNMP) counters?
slug: '309997970'
tags: kb kbcore kbstatistics kbsnmp
title: What packets are counted in "Forwarded bps" and "Forwarded pps" statistics
  (and SNMP) counters?
version: 5
---

<ac:layout><ac:layout-section ac:type="two_equal"><ac:layout-cell><ac:structured-macro ac:name="excerpt" ac:schema-version="1" ac:macro-id="2a6e168f-b284-4015-a70f-5110bdc4ede8"><ac:parameter ac:name="atlassian-macro-output-type">INLINE</ac:parameter><ac:rich-text-body><p>In short: forwarded, layer 3+ bytes that are SENT are counted.</p></ac:rich-text-body></ac:structured-macro><p><br /></p><p><ac:placeholder>Labels to use for the page: </ac:placeholder></p><p><ac:placeholder>kb - use on all </ac:placeholder></p><p><ac:placeholder>kbhowto - How-To:s</ac:placeholder></p><p><ac:placeholder>kbtroubleshoot - Finding and diagnosing problems </ac:placeholder></p><p><ac:placeholder>kbknownproblem - Describe a known problem, possibly with fixes/workarounds </ac:placeholder></p><p><br /></p><p><ac:placeholder>kbcore / kbstream / kbincontrol / kbincenter / kboneconnect / ... - our products </ac:placeholder></p><p><ac:placeholder>kbdhcp / kbipsec / kbospf / kbl2tp - protocol names </ac:placeholder></p><p><ac:placeholder>kbcrypto / kbmtu / ... - broad topics, mentions of other products, etcetc, you get the idea! </ac:placeholder></p><p><br /></p></ac:layout-cell><ac:layout-cell><ac:structured-macro ac:name="details" ac:schema-version="1" ac:macro-id="d6c80c04-42e9-45c0-8446-1df87ed8ca22"><ac:rich-text-body><table class="wrapped"><colgroup> <col /> <col /> </colgroup><tbody><tr><td><p>Up to date for</p></td><td><p>Core 12.00.20</p><p><ac:placeholder>InControl 2.0.0 </ac:placeholder></p><p><ac:placeholder>OtherProduct 2000 </ac:placeholder></p></td></tr><tr><td colspan="1">Status</td><td colspan="1"><div class="content-wrapper"><p>&nbsp;<ac:structured-macro ac:name="status" ac:schema-version="1" ac:macro-id="000e7e8f-43e7-42ba-90a3-a0bc34ddfd27"><ac:parameter ac:name="colour">Green</ac:parameter><ac:parameter ac:name="title">OK</ac:parameter></ac:structured-macro>&nbsp;</p><p><ac:placeholder>DRAFT: still working on this </ac:placeholder></p><p><ac:placeholder>OK: usable (doesn't have to mean final!) </ac:placeholder></p><p><ac:placeholder>OLD: information is out of date </ac:placeholder></p><p><ac:placeholder>NEVERPUBLIC: never consider it for publication.</ac:placeholder></p></div></td></tr></tbody></table></ac:rich-text-body></ac:structured-macro></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="single"><ac:layout-cell><h1>The base principle</h1><ul><li><strong>We count bytes SENT at IP level</strong> = bytes given to the layer 2 drivers. <br /><ul><li>Note that past this point, ARP resolution, tunnel negotiation, interface drivers can still fail to deliver the packet. This does not affect the &quot;Forwarded&quot; statistic.</li></ul></li><li>Only bytes Layer 3 and up are counted = IP headers and the data beneath them. Not Ethernet headers, outer ESP where the firewall is a VPN endpoint, etc.</li><li>Packets originated by the firewall itself (log data, management traffic, etc) are (mostly) not counted.</li></ul><h2>But VPN tunnels?</h2><p>We measure <strong>data forwarded into / out of a tunnel</strong>, not the outer encapsulation, as that part of the packet is considered &quot;originated by the firewall itself&quot;.</p><h2>But some legacy exceptions</h2><p>ICMP Echo responses are counted for legacy reasons.</p><p>ICMP errors and TCP RSTs are similarly counted for legacy reasons.</p><p><br /></p></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="single"><ac:layout-cell><h1>Related articles</h1><p><ac:structured-macro ac:name="contentbylabel" ac:schema-version="3" ac:macro-id="09f84fb0-0e4a-4e28-bf7e-73c9368f4574"><ac:parameter ac:name="sort">modified</ac:parameter><ac:parameter ac:name="excerptType">rich content</ac:parameter><ac:parameter ac:name="cql">label in (&quot;kbstatistics&quot;,&quot;kbsnmp&quot;) and type = &quot;page&quot;</ac:parameter></ac:structured-macro></p><p><ac:placeholder> Change the labels in the macro to match suitably narrow labels, e.g. &quot;kbdhcp, kbrouting&quot; but not &quot;kbcore&quot;/&quot;kbhowto&quot;/&quot;kb&quot;/&quot;kbdictionary&quot;. Pages with ANY of the labels will be shown - it's _not_ a &quot;must match all&quot; filter. (You can of course use as much advanced filtering as you like!) </ac:placeholder></p><p><br /></p><p><br /></p></ac:layout-cell></ac:layout-section></ac:layout>