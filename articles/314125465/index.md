---
confluence-id: '314125465'
date: '2020-09-08T01:19:35.000+02:00'
last_modified_at: '2020-09-08T01:19:35.000+02:00'
layout: article
orig-title: Why does WireShark say that SNMPv3 traps sent from cOS Core are "snmpV2-trap"?
orig-title-slugified: why-does-wireshark-say-that-snmpv3-traps-sent-from-cos-core-are-snmpv2-trap-
permalink: /kb/314125465/#!why-does-wireshark-say-that-snmpv3-traps-sent-from-cos-core-are-snmpv2-trap-
published: 'true'
slug: '314125465'
tags: kb kbsnmp kbcore kbwireshark
title: Why does WireShark say that SNMPv3 traps sent from cOS Core are "snmpV2-trap"?
version: 3
---

<ac:layout><ac:layout-section ac:type="two_equal"><ac:layout-cell><ac:structured-macro ac:name="excerpt" ac:schema-version="1" ac:macro-id="2a6e168f-b284-4015-a70f-5110bdc4ede8"><ac:parameter ac:name="atlassian-macro-output-type">INLINE</ac:parameter><ac:rich-text-body><p>The data portion of SNMPv3 and SNMPv2 traps are identical. Only the wrapping headers differ. Wireshark shows the data portion in the summary line.</p></ac:rich-text-body></ac:structured-macro><p><br /></p><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="b14ec6bf-c24f-4c52-ae96-1779f5f720df" /></p></ac:layout-cell><ac:layout-cell><ac:structured-macro ac:name="details" ac:schema-version="1" ac:macro-id="d6c80c04-42e9-45c0-8446-1df87ed8ca22"><ac:rich-text-body><table class="wrapped"><colgroup> <col /> <col /> </colgroup><tbody><tr><td><p>Up to date for</p></td><td><p>Core 12.00.22</p><p>Core 13.00.01</p><p>WireShark 2.6.10</p></td></tr><tr><td colspan="1">Status</td><td colspan="1"><div class="content-wrapper"><p>&nbsp;<ac:structured-macro ac:name="status" ac:schema-version="1" ac:macro-id="000e7e8f-43e7-42ba-90a3-a0bc34ddfd27"><ac:parameter ac:name="colour">Green</ac:parameter><ac:parameter ac:name="title">OK</ac:parameter></ac:structured-macro>&nbsp;</p></div></td></tr></tbody></table></ac:rich-text-body></ac:structured-macro></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="single"><ac:layout-cell><h1>Manually testing SNMP trap behavior using ucs-snmp</h1><p>This can be tested on e.g. a Linux host:</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="011b77c8-f65c-43fb-b986-620cc4483b60"><ac:parameter ac:name="language">bash</ac:parameter><ac:plain-text-body><![CDATA[$ snmptrap -v 2c -c public 192.168.0.101 '' 1.3.6.1.4.1.8072.2.3.0.1 1.3.6.1.4.1.8072.2.3.2.1 i 123456

$ snmptrap -v 3 -u ExampleSecurityName -l noAuthNoPriv 192.168.0.101 '' 1.3.6.1.4.1.8072.2.3.0.1 1.3.6.1.4.1.8072.2.3.2.1 i 123456]]></ac:plain-text-body></ac:structured-macro><p>If you walk inside the packet data, you'll see that the trap data itself is identical in both v2 and v3, but they're wrapped in different headers (v2 vs v3).</p><h2>SNMPv2 trap:</h2><p><ac:image ac:queryparams="effects=border-simple,shadow-kn" ac:width="600"><ri:attachment ri:filename="image2020-1-3_16-32-38.png" /></ac:image></p><h2>SNMPv3 trap</h2><p><ac:image ac:queryparams="effects=border-simple,shadow-kn" ac:width="600"><ri:attachment ri:filename="image2020-1-3_17-7-27.png" /></ac:image></p><p>Note that the contained data is still identified as a &quot;v2 trap&quot;, it is unchanged.</p><p><br /></p></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="single"><ac:layout-cell><h1>Related articles</h1><p><ac:structured-macro ac:name="contentbylabel" ac:schema-version="3" ac:macro-id="df3e5f18-917e-45cf-9e24-7d6c2722839c"><ac:parameter ac:name="sort">modified</ac:parameter><ac:parameter ac:name="excerptType">rich content</ac:parameter><ac:parameter ac:name="cql">label = &quot;kbsnmp&quot; and type = &quot;page&quot;</ac:parameter></ac:structured-macro></p><p><ac:placeholder> Change the labels in the macro to match suitably narrow labels, e.g. &quot;kbdhcp, kbrouting&quot; but not &quot;kbcore&quot;/&quot;kbhowto&quot;/&quot;kb&quot;/&quot;kbdictionary&quot;. Pages with ANY of the labels will be shown - it's _not_ a &quot;must match all&quot; filter. (You can of course use as much advanced filtering as you like!) </ac:placeholder></p><p><br /></p><p><br /></p></ac:layout-cell></ac:layout-section></ac:layout>